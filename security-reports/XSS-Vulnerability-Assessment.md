# ðŸ›¡ï¸ Cross-Site Scripting (XSS) Vulnerability Assessment & Forensics Report

**Target Application:** Damn Vulnerable Web Application (DVWA)  
**Vulnerability Class:** OWASP Top 10 â€“ A03: Injection (Cross-Site Scripting)  
**Assessment Type:** Controlled Lab Penetration Test (Educational)  
**Deployment Model:** Dockerized Web Application  
**Primary Tooling:** Burp Suite (Proxy, Repeater), Web Browser  
**Author:** David Rotshak  
**Date:** 30 January 2026  

---

## 1. Executive Summary

This report documents the discovery, exploitation, and mitigation of a **Reflected Cross-Site Scripting (XSS)** vulnerability identified within a **Docker-deployed** instance of the Damn Vulnerable Web Application (DVWA).

The vulnerability allowed **arbitrary JavaScript execution** in the victimâ€™s browser by reflecting unsanitized user input directly into server responses. Exploitation was confirmed using controlled payloads injected via **Burp Suite Repeater**, resulting in successful client-side code execution.

This class of vulnerability poses a **high security risk**, enabling session hijacking, credential theft, phishing attacks, and malicious content injection.

---

## 2. Scope & Environment

### 2.1 Assessment Scope

- **Application:** Damn Vulnerable Web Application (DVWA)
- **Vulnerability Class:** Reflected Cross-Site Scripting (XSS)
- **Module Tested:** XSS (Reflected)
- **Security Level:** Low
- **Access Level:** Authenticated user session
- **Network Scope:** Localhost (Docker bridge network)

---

### 2.2 Deployment Architecture (Docker)

DVWA was deployed using a **containerized Docker environment**, ensuring isolation, reproducibility, and controlled testing conditions.

| Component        | Details                                  |
|------------------|-------------------------------------------|
| Container Engine | Docker                                    |
| Web Server       | Apache (within container)                 |
| Backend Language | PHP                                       |
| Database         | MariaDB (containerized)                   |
| Client Browser   | Chromium                                  |
| Intercept Proxy  | Burp Suite Community                      |
| Target URL       | http://127.0.0.1                          |

---

### ðŸ“¸ Evidence Placeholder â€” Dockerized DVWA Environment

> _Insert screenshot showing running DVWA Docker container (e.g. `docker ps`)_

```text
[ IMAGE PLACEHOLDER â€“ Docker container running DVWA ]
````

---

## 3. Methodology

A **black-box penetration testing methodology** was used, simulating the actions of an external attacker with no knowledge of the applicationâ€™s source code or internal logic.

Burp Suite was configured as an **intercepting proxy** between the client browser and the Dockerized DVWA instance, allowing full inspection and manipulation of HTTP traffic.

### 3.1 Testing Phases

1. Application interaction and baseline behavior observation
2. HTTP request interception via Burp Proxy
3. Payload manipulation using Burp Repeater
4. Server response analysis
5. Browser-based JavaScript execution confirmation
6. Root cause identification
7. Mitigation validation

---

### ðŸ“¸ Evidence Placeholder â€” Burp Proxy Configuration

> *Insert screenshot showing browser traffic captured in Burp Proxy HTTP history*

```text
[ IMAGE PLACEHOLDER â€“ Burp Proxy HTTP history capturing DVWA traffic ]
```

---

## 4. Vulnerability Discovery

### 4.1 Initial Request Capture

While interacting with the **XSS (Reflected)** module, a legitimate request was captured via Burp Proxy:

```http
GET /dvwa/vulnerabilities/xss_r/?name=test HTTP/1.1
Host: 127.0.0.1
Cookie: PHPSESSID=<session_id>; security=low
```

The request was forwarded to **Burp Repeater** for controlled modification and replay.

---

### ðŸ“¸ Evidence Placeholder â€” Intercepted HTTP Request

> *Insert screenshot of Burp Repeater showing the original request*

```text
[ IMAGE PLACEHOLDER â€“ Original reflected XSS request in Burp Repeater ]
```

---

## 5. Payload Injection & Exploitation

### 5.1 Injected Payload

The following JavaScript payload was used to test for reflected XSS:

```html
<script>alert('XSS')</script>
```

This payload was injected by modifying the `name` parameter in Burp Repeater.

Modified request:

```http
GET /dvwa/vulnerabilities/xss_r/?name=<script>alert('XSS')</script> HTTP/1.1
Host: 127.0.0.1
Cookie: PHPSESSID=<session_id>; security=low
```

---

### ðŸ“¸ Evidence Placeholder â€” Modified Request with Payload

> *Insert screenshot showing payload injected in Burp Repeater*

```text
[ IMAGE PLACEHOLDER â€“ Modified request containing XSS payload ]
```

---

### 5.2 Server Response Analysis

The server response reflected the payload without sanitization or encoding:

```html
Hello <script>alert('XSS')</script>
```

This confirms that user input was embedded directly into the HTML response.

---

### ðŸ“¸ Evidence Placeholder â€” Reflected Payload in Response

> *Insert screenshot showing reflected payload in HTTP response*

```text
[ IMAGE PLACEHOLDER â€“ Reflected payload visible in Burp response ]
```

## 6. Browser-Based Execution Confirmation

To confirm real-world impact, the crafted request containing the injected payload was rendered directly in the client browser. Rendering the response in the browser context is required to validate JavaScript execution, as Burp Repeater alone does not execute client-side code.

Upon loading the crafted URL, the browser executed the injected JavaScript payload, resulting in a visible alert dialog.

```

XSS

````

This confirms **arbitrary JavaScript execution** within the context of the victimâ€™s browser session.

---

### ðŸ“¸ Evidence Placeholder â€” XSS Payload Execution

> _Insert screenshot showing browser alert dialog with text "XSS"_

```text
[ IMAGE PLACEHOLDER â€“ Browser alert confirming XSS execution ]
````

---

## 7. Exploitation Notes & Payload Behavior

During testing, multiple payload variants were evaluated to assess execution behavior:

| Payload Type                    | Result          | Notes                                                     |
| ------------------------------- | --------------- | --------------------------------------------------------- |
| `<script>alert('XSS')</script>` | Executed        | Reliable execution in reflected HTML context              |
| `<img src=x onerror=alert(1)>`  | Did not execute | Contextual parsing and browser behavior limited execution |

This highlights an important security insight: **XSS payload effectiveness is context-dependent**. Successful exploitation relies on understanding how user input is embedded within the DOM and parsed by the browser.

---

## 8. Impact Assessment

### 8.1 Security Impact

Successful exploitation of this vulnerability enables an attacker to:

* Execute arbitrary JavaScript in the victimâ€™s browser
* Steal session cookies and authentication tokens
* Perform phishing and social engineering attacks
* Modify page content dynamically
* Pivot to additional client-side attacks

---

### 8.2 Risk Classification

| Category             | Assessment            |
| -------------------- | --------------------- |
| OWASP Classification | A03 â€“ Injection (XSS) |
| CVSS (Estimated)     | 7.5 â€“ High            |
| Attack Vector        | Network               |
| Exploit Complexity   | Low                   |
| Privileges Required  | Low (authenticated)   |
| User Interaction     | Required              |
| Scope                | Client-side           |

---

## 9. Root Cause Analysis

The vulnerability exists due to insecure handling of untrusted input within server-side output logic.

### Vulnerable Pattern (Simplified)

```php
echo "Hello " . $_GET['name'];
```

Root causes include:

* Lack of output encoding
* Implicit trust in user-supplied data
* Absence of Content Security Policy (CSP)
* No contextual sanitization based on output location

As a result, user input was interpreted as executable code rather than inert data.

---

## 10. Mitigation & Remediation

### 10.1 Primary Mitigation â€” Output Encoding

All user-controlled data must be encoded before rendering in HTML responses.

#### Secure Implementation (PHP)

```php
$name = htmlspecialchars($_GET['name'], ENT_QUOTES, 'UTF-8');
echo "Hello " . $name;
```

This ensures special characters are safely rendered as text and cannot be executed by the browser.

---

### 10.2 Defense-in-Depth â€” Content Security Policy (CSP)

Implementing a strict CSP significantly reduces the impact of residual XSS vulnerabilities.

#### Recommended HTTP Header

```http
Content-Security-Policy: default-src 'self'; script-src 'self';
```

This prevents:

* Inline script execution
* Event handler execution (`onerror`, `onclick`)
* External script injection

---

### 10.3 Input Validation (Supplementary Control)

While not sufficient alone, input validation reduces attack surface:

```php
if (!preg_match('/^[a-zA-Z0-9 ]+$/', $name)) {
    die("Invalid input");
}
```

âš ï¸ Input validation **must never replace output encoding**.

---

## 11. Verification of Mitigation

After applying output encoding and CSP controls:

* Injected payloads were rendered as harmless text
* JavaScript execution was fully prevented
* Browser alerts no longer appeared

---

### ðŸ“¸ Evidence Placeholder â€” Post-Mitigation Behavior

> *Insert screenshot showing encoded payload rendered as text*

```text
[ IMAGE PLACEHOLDER â€“ Payload rendered safely after mitigation ]
```

---

## 12. Lessons Learned

* XSS is a **design flaw**, not an input-filtering issue
* Output encoding is the most reliable prevention mechanism
* Payload behavior is highly context-dependent
* Burp Suite enables precise request manipulation
* Dockerized environments provide safe, reproducible testing labs

---

## 13. Conclusion

This assessment demonstrates a complete Reflected XSS attack lifecycle against a Docker-deployed DVWA instance. The vulnerability was easily exploitable due to unsafe output handling and lack of defensive controls.

By implementing **context-aware output encoding**, enforcing a **Content Security Policy**, and validating user input, the vulnerability was fully mitigated.

This project reinforces foundational web security principles and demonstrates practical offensive and defensive security skills within a controlled lab environment.

---

## 14. References

* OWASP Top 10 â€“ A03: Injection
* OWASP Cross-Site Scripting Prevention Cheat Sheet
* PortSwigger Web Security Academy
* Mozilla Content Security Policy Documentation

```
