# üõ°Ô∏è Cross-Site Scripting (Stored XSS) Vulnerability Assessment & Forensics Report

**Target Application:** Damn Vulnerable Web Application (DVWA)
**Vulnerability Class:** OWASP Top 10 ‚Äì A03: Injection (Cross-Site Scripting ‚Äì Stored)
**Assessment Type:** Controlled Lab Penetration Test (Educational)
**Deployment Model:** Dockerized Web Application
**Primary Tooling:** Burp Suite (Proxy, Repeater), Web Browser
**Author:** David Rotshak
**Date:** 30 January 2026

---

# 1. Executive Summary

This report documents the discovery, exploitation, and mitigation of a **Stored (Persistent) Cross-Site Scripting (XSS)** vulnerability identified within a Docker-deployed instance of the Damn Vulnerable Web Application (DVWA).

The vulnerability allowed arbitrary JavaScript to be permanently stored within the application‚Äôs backend database and executed automatically in the browser of any user who accessed the affected page.

Exploitation was confirmed using controlled payloads submitted through the application interface and intercepted via Burp Suite. The injected payload persisted across page reloads and sessions, demonstrating full persistent client-side code execution.

Stored XSS presents a high security risk due to its self-executing nature and ability to impact multiple users without requiring victim interaction.

---

# 2. Scope & Environment

## 2.1 Assessment Scope

* **Application:** Damn Vulnerable Web Application (DVWA)
* **Vulnerability Class:** Stored Cross-Site Scripting (XSS)
* **Module Tested:** XSS (Stored)
* **Security Level:** Low
* **Access Level:** Authenticated user session
* **Network Scope:** Localhost (Docker bridge network)

---

## 2.2 Deployment Architecture (Docker)

DVWA was deployed in a containerized Docker environment to ensure:

* Isolation
* Controlled reproducibility
* Safe exploitation testing

| Component        | Details                              |
| ---------------- | ------------------------------------ |
| Container Engine | Docker                               |
| Web Server       | Apache (within container)            |
| Backend Language | PHP                                  |
| Database         | MariaDB (containerized)              |
| Client Browser   | Chromium                             |
| Intercept Proxy  | Burp Suite Community                 |
| Target URL       | [http://127.0.0.1](http://127.0.0.1) |

---

### üì∏ Evidence Placeholder

<img width="1717" height="1002" alt="burpsuite7" src="https://github.com/user-attachments/assets/49f513da-59f5-43b8-8dcc-a9d5af2021b4" />

Docker container running DVWA

---

# 3. Methodology

A structured black-box penetration testing methodology was applied, simulating the behavior of an authenticated user attempting to manipulate application input fields.

Burp Suite was configured as an intercepting proxy to inspect and modify HTTP requests between the browser and the Dockerized DVWA instance.

---

## 3.1 Testing Phases

1. Baseline interaction with Stored XSS module
2. Interception of POST request via Burp Proxy
3. Payload injection through form fields
4. Server response inspection
5. Persistence validation (page reload and session test)
6. Browser-based execution confirmation
7. Root cause analysis
8. Mitigation validation

---

### üì∏ Evidence Placeholder ‚Äî Burp Proxy Capturing Stored XSS Request

[ IMAGE PLACEHOLDER ‚Äì Burp HTTP history capturing POST request ]

---

# 4. Vulnerability Discovery

## 4.1 Initial Request Capture

While interacting with the **XSS (Stored)** module, the following legitimate POST request was captured:

```
POST /dvwa/vulnerabilities/xss_s/ HTTP/1.1
Host: 127.0.0.1
Cookie: PHPSESSID=<session_id>; security=low
```

The request body contained:

```
txtName=test
mtxMessage=hello
btnSign=Sign+Guestbook
```

This request was forwarded to Burp Repeater for controlled payload modification.

---

### üì∏ Evidence Placeholder ‚Äî Intercepted Stored XSS Request

[ IMAGE PLACEHOLDER ‚Äì Original POST request in Burp Repeater ]

---

# 5. Payload Injection & Exploitation

## 5.1 Injected Payload

The following JavaScript payload was injected into the **message field**:

```html
<script>alert('Stored XSS')</script>
```

Modified request:

```
POST /dvwa/vulnerabilities/xss_s/ HTTP/1.1
Host: 127.0.0.1
Cookie: PHPSESSID=<session_id>; security=low

txtName=attacker
mtxMessage=<script>alert('Stored XSS')</script>
btnSign=Sign+Guestbook
```

---

### üì∏ Evidence Placeholder ‚Äî Modified POST Request with Malicious Payload

[ IMAGE PLACEHOLDER ‚Äì Burp Repeater showing injected script ]

---

## 5.2 Server Response Analysis

The server accepted the payload without sanitization or encoding and stored it in the backend database.

Upon page reload, the response contained:

```html
<script>alert('Stored XSS')</script>
```

This confirms the payload was permanently embedded in the application output.

---

### üì∏ Evidence Placeholder ‚Äî Stored Payload Visible in HTTP Response

[ IMAGE PLACEHOLDER ‚Äì Burp response containing stored script ]

---

# 6. Browser-Based Execution Confirmation

To validate real-world impact, the page containing the stored payload was rendered in the browser.

Upon loading the page:

* The injected JavaScript executed automatically
* An alert dialog appeared
* The alert re-triggered upon refresh

This confirms persistent client-side code execution affecting any authenticated user who accesses the page.

---

### üì∏ Evidence Placeholder ‚Äî Stored XSS Alert Execution

[ IMAGE PLACEHOLDER ‚Äì Browser alert confirming persistent execution ]

---

# 7. Exploitation Notes & Payload Behavior

Multiple payload variants were tested:

| Payload                                | Result   | Notes                            |
| -------------------------------------- | -------- | -------------------------------- |
| `<script>alert('Stored XSS')</script>` | Executed | Reliable persistent execution    |
| `<img src=x onerror=alert(1)>`         | Executed | Context-dependent but successful |
| Script reload test                     | Executed | Confirmed persistence            |

Key observation:

Stored XSS executes automatically without requiring user interaction, increasing exploit severity.

---

# 8. Impact Assessment

## 8.1 Security Impact

Successful Stored XSS exploitation enables:

* Automatic execution of attacker-controlled JavaScript
* Session cookie theft
* Account takeover (if administrator views page)
* Phishing injection
* Client-side data exfiltration
* Persistent defacement

---

## 8.2 Risk Classification

| Category             | Assessment               |
| -------------------- | ------------------------ |
| OWASP Classification | A03 ‚Äì Injection (XSS)    |
| CVSS (Estimated)     | 8.2 ‚Äì High               |
| Attack Vector        | Network                  |
| Exploit Complexity   | Low                      |
| Privileges Required  | Low (authenticated)      |
| User Interaction     | Not Required             |
| Scope                | Client-side (persistent) |

Stored XSS presents elevated risk due to persistence and multi-user impact.

---

# 9. Root Cause Analysis

The vulnerability exists due to unsafe output handling of user-supplied data.

Vulnerable pattern (simplified):

```php
echo $row['message'];
```

Root causes:

* Absence of output encoding
* Trusting user-controlled input
* No Content Security Policy (CSP) enforcement
* Failure to treat user input as untrusted data

User input was rendered as executable HTML instead of inert text.

---

# 10. Mitigation & Remediation

## 10.1 Primary Mitigation ‚Äî Output Encoding

All stored user data must be encoded before rendering.

Secure implementation:

```php
$message = htmlspecialchars($row['message'], ENT_QUOTES, 'UTF-8');
echo $message;
```

This prevents execution of embedded scripts.

---

## 10.2 Defense-in-Depth ‚Äî Content Security Policy (CSP)

Recommended HTTP Header:

```
Content-Security-Policy: default-src 'self'; script-src 'self';
```

Prevents:

* Inline script execution
* Event handler injection
* External malicious script loading

---

## 10.3 Input Validation (Supplementary Control)

```php
if (!preg_match('/^[a-zA-Z0-9 ]+$/', $message)) {
    die("Invalid input");
}
```

‚ö†Ô∏è Input validation does not replace output encoding.

---

# 11. Verification of Mitigation

After implementing encoding and CSP:

* Injected payload rendered as text
* No JavaScript execution occurred
* Alert dialogs no longer appeared
* Stored data remained non-executable

---

### üì∏ Evidence Placeholder ‚Äî Post-Mitigation Encoded Output

[ IMAGE PLACEHOLDER ‚Äì Encoded payload rendered safely ]

---

# 12. Lessons Learned

* Stored XSS presents higher risk than reflected XSS
* Persistence significantly increases attack impact
* Output encoding is the most effective prevention control
* CSP provides strong defense-in-depth
* Secure design principles must treat all input as untrusted
* Docker environments enable safe vulnerability research

---

# 13. Conclusion

This assessment demonstrates a complete **Stored Cross-Site Scripting attack lifecycle** against a Docker-deployed DVWA instance.

The vulnerability allowed permanent injection and automatic execution of malicious JavaScript within authenticated user sessions.

Through proper output encoding and implementation of Content Security Policy controls, exploitation was successfully mitigated.

This project demonstrates applied knowledge of web application security testing, exploitation techniques, and defensive remediation practices within a controlled laboratory environment.

---

# 14. References

* OWASP Top 10 ‚Äì A03: Injection
* OWASP Cross-Site Scripting Prevention Cheat Sheet
* PortSwigger Web Security Academy
* Mozilla Content Security Policy Documentation
* DVWA Project Documentation

---
